"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/inpaint-image";
exports.ids = ["pages/api/inpaint-image"];
exports.modules = {

/***/ "form-data":
/*!****************************!*\
  !*** external "form-data" ***!
  \****************************/
/***/ ((module) => {

module.exports = require("form-data");

/***/ }),

/***/ "jimp":
/*!***********************!*\
  !*** external "jimp" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("jimp");

/***/ }),

/***/ "multer":
/*!*************************!*\
  !*** external "multer" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("multer");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "axios":
/*!************************!*\
  !*** external "axios" ***!
  \************************/
/***/ ((module) => {

module.exports = import("axios");;

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Finpaint-image&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cinpaint-image.ts&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Finpaint-image&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cinpaint-image.ts&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_inpaint_image_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\inpaint-image.ts */ \"(api)/./pages/api/inpaint-image.ts\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_inpaint_image_ts__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_inpaint_image_ts__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_inpaint_image_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_inpaint_image_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/inpaint-image\",\n        pathname: \"/api/inpaint-image\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_inpaint_image_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmlucGFpbnQtaW1hZ2UmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2lucGFpbnQtaW1hZ2UudHMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDMkQ7QUFDM0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHdEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyx3REFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQscUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1pbWFnZS1nZW5lcmF0b3ItbmV4dGpzLz8xZGQyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9wYWdlc1xcXFxhcGlcXFxcaW5wYWludC1pbWFnZS50c1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2lucGFpbnQtaW1hZ2VcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9pbnBhaW50LWltYWdlXCIsXG4gICAgICAgIC8vIFRoZSBmb2xsb3dpbmcgYXJlbid0IHVzZWQgaW4gcHJvZHVjdGlvbi5cbiAgICAgICAgYnVuZGxlUGF0aDogXCJcIixcbiAgICAgICAgZmlsZW5hbWU6IFwiXCJcbiAgICB9LFxuICAgIHVzZXJsYW5kXG59KTtcblxuLy8jIHNvdXJjZU1hcHBpbmdVUkw9cGFnZXMtYXBpLmpzLm1hcCJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Finpaint-image&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cinpaint-image.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/inpaint-image.ts":
/*!************************************!*\
  !*** ./pages/api/inpaint-image.ts ***!
  \************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var axios__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! axios */ \"axios\");\n/* harmony import */ var multer__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! multer */ \"multer\");\n/* harmony import */ var multer__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(multer__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jimp__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jimp */ \"jimp\");\n/* harmony import */ var jimp__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jimp__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var form_data__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! form-data */ \"form-data\");\n/* harmony import */ var form_data__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(form_data__WEBPACK_IMPORTED_MODULE_3__);\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([axios__WEBPACK_IMPORTED_MODULE_0__]);\naxios__WEBPACK_IMPORTED_MODULE_0__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n\nconst STABILITY_API_KEY = process.env.STABILITY_API_KEY;\nconst STABILITY_INPAINT_URL = \"https://api.stability.ai/v2beta/stable-image/edit/inpaint\";\n// Configure multer for file uploads\nconst upload = multer__WEBPACK_IMPORTED_MODULE_1___default()({\n    storage: multer__WEBPACK_IMPORTED_MODULE_1___default().memoryStorage(),\n    limits: {\n        fileSize: 10 * 1024 * 1024 // 10MB limit\n    }\n});\n// Disable body parser for this route to handle multipart data\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\n// Helper to run multer middleware\nfunction runMiddleware(req, res, fn) {\n    return new Promise((resolve, reject)=>{\n        fn(req, res, (result)=>{\n            if (result instanceof Error) {\n                return reject(result);\n            }\n            return resolve(result);\n        });\n    });\n}\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        // Run multer middleware\n        await runMiddleware(req, res, upload.fields([\n            {\n                name: \"image\",\n                maxCount: 1\n            },\n            {\n                name: \"mask\",\n                maxCount: 1\n            }\n        ]));\n        const files = req.files;\n        const body = req.body;\n        console.log(\"req.body:\", body);\n        const prompt = body.prompt || \"\";\n        const negativePrompt = body.negative_prompt || \"\";\n        const steps = body.steps;\n        const cfgScale = body.cfg_scale;\n        const samples = body.samples;\n        const imageFile = files[\"image\"]?.[0];\n        const maskFile = files[\"mask\"]?.[0];\n        if (!STABILITY_API_KEY) {\n            return res.status(500).json({\n                error: \"Stability AI API key not configured. Please set STABILITY_API_KEY in your .env.local file.\"\n            });\n        }\n        if (!imageFile || !maskFile) {\n            return res.status(400).json({\n                error: \"Both image and mask files are required\"\n            });\n        }\n        // Process and resize image and mask to 1024x1024\n        const targetWidth = 1024;\n        const targetHeight = 1024;\n        // For the image\n        const imageBuffer = imageFile.buffer;\n        const imageJimp = await jimp__WEBPACK_IMPORTED_MODULE_2___default().read(imageBuffer);\n        imageJimp.resize(targetWidth, targetHeight);\n        const processedImageBuffer = await imageJimp.getBufferAsync((jimp__WEBPACK_IMPORTED_MODULE_2___default().MIME_PNG));\n        // For the mask\n        const maskBuffer = maskFile.buffer;\n        const maskImageJimp = await jimp__WEBPACK_IMPORTED_MODULE_2___default().read(maskBuffer);\n        maskImageJimp.resize(targetWidth, targetHeight).greyscale().scan(0, 0, targetWidth, targetHeight, function(x, y, idx) {\n            // If pixel is closer to white, set to white; else set to black\n            const value = this.bitmap.data[idx] > 128 ? 255 : 0;\n            this.bitmap.data[idx] = value;\n            this.bitmap.data[idx + 1] = value;\n            this.bitmap.data[idx + 2] = value;\n            this.bitmap.data[idx + 3] = 255; // opaque\n        });\n        const processedMaskBuffer = await maskImageJimp.getBufferAsync((jimp__WEBPACK_IMPORTED_MODULE_2___default().MIME_PNG));\n        // Create form data for multipart upload\n        const formData = new (form_data__WEBPACK_IMPORTED_MODULE_3___default())();\n        // Required fields\n        formData.append(\"image\", processedImageBuffer, {\n            filename: \"image.png\",\n            contentType: \"image/png\"\n        });\n        formData.append(\"prompt\", prompt);\n        // Optional fields\n        if (maskFile) {\n            formData.append(\"mask\", processedMaskBuffer, {\n                filename: \"mask.png\",\n                contentType: \"image/png\"\n            });\n        }\n        if (negativePrompt) formData.append(\"negative_prompt\", negativePrompt);\n        if (body.seed) formData.append(\"seed\", body.seed);\n        if (body.output_format) {\n            formData.append(\"output_format\", body.output_format);\n        } else {\n            formData.append(\"output_format\", \"png\");\n        }\n        if (body.style_preset) formData.append(\"style_preset\", body.style_preset);\n        if (cfgScale) formData.append(\"cfg_scale\", cfgScale);\n        if (steps) formData.append(\"steps\", steps);\n        console.log(\"Prompt:\", prompt);\n        console.log(\"Negative Prompt:\", negativePrompt);\n        console.log(\"Processed image buffer size:\", processedImageBuffer.length);\n        console.log(\"Processed mask buffer size:\", processedMaskBuffer.length);\n        // Log FormData fields\n        console.log(\"FormData fields:\");\n        console.log(\"Type of formData:\", typeof formData);\n        console.log(\"formData constructor:\", formData.constructor.name);\n        // Alternative logging approach that doesn't rely on forEach\n        try {\n            if (typeof formData.forEach === \"function\") {\n                formData.forEach((value, key)=>{\n                    if (Buffer.isBuffer(value) || value instanceof Uint8Array) {\n                        console.log(`  ${key}: [binary, length ${value.length}]`);\n                    } else {\n                        console.log(`  ${key}:`, value);\n                    }\n                });\n            } else {\n                console.log(\"FormData forEach method not available\");\n                // Just log that FormData was created successfully\n                console.log(\"FormData object created successfully\");\n                const headers = formData.getHeaders();\n                console.log(\"FormData headers:\", headers);\n            }\n        } catch (error) {\n            console.log(\"Error logging FormData fields:\", error.message);\n        }\n        const response = await axios__WEBPACK_IMPORTED_MODULE_0__[\"default\"].post(STABILITY_INPAINT_URL, formData, {\n            headers: {\n                \"Authorization\": `Bearer ${STABILITY_API_KEY}`,\n                ...formData.getHeaders(),\n                \"Accept\": \"application/json\"\n            }\n        });\n        // Handle v2beta response\n        let images = [];\n        if (response.data.image) {\n            images.push({\n                base64: `data:image/png;base64,${response.data.image}`,\n                seed: response.data.seed\n            });\n        } else if (Array.isArray(response.data.images)) {\n            images = response.data.images.map((img)=>({\n                    base64: `data:image/png;base64,${img.image}`,\n                    seed: img.seed\n                }));\n        } else {\n            // Unexpected response\n            return res.status(500).json({\n                error: \"Unexpected response from Stability API\",\n                details: response.data\n            });\n        }\n        res.json({\n            success: true,\n            images,\n            usage: response.data.usage\n        });\n    } catch (error) {\n        console.error(\"Error inpainting image:\", error.response?.data || error.message || error);\n        res.status(500).json({\n            error: \"Failed to inpaint image\",\n            details: error.response?.data || error.message || error\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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WUFDUGlFLFNBQVNqRSxNQUFNdUQsUUFBUSxFQUFFbkIsUUFBUXBDLE1BQU1zRCxPQUFPLElBQUl0RDtRQUNwRDtJQUNGO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9haS1pbWFnZS1nZW5lcmF0b3ItbmV4dGpzLy4vcGFnZXMvYXBpL2lucGFpbnQtaW1hZ2UudHM/MGZkZSJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgdHlwZSB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0JztcclxuaW1wb3J0IGF4aW9zIGZyb20gJ2F4aW9zJztcclxuaW1wb3J0IG11bHRlciBmcm9tICdtdWx0ZXInO1xyXG5pbXBvcnQgSmltcCBmcm9tICdqaW1wJztcclxuaW1wb3J0IEZvcm1EYXRhIGZyb20gJ2Zvcm0tZGF0YSc7XHJcblxyXG5jb25zdCBTVEFCSUxJVFlfQVBJX0tFWSA9IHByb2Nlc3MuZW52LlNUQUJJTElUWV9BUElfS0VZO1xyXG5jb25zdCBTVEFCSUxJVFlfSU5QQUlOVF9VUkwgPSAnaHR0cHM6Ly9hcGkuc3RhYmlsaXR5LmFpL3YyYmV0YS9zdGFibGUtaW1hZ2UvZWRpdC9pbnBhaW50JztcclxuXHJcbi8vIENvbmZpZ3VyZSBtdWx0ZXIgZm9yIGZpbGUgdXBsb2Fkc1xyXG5jb25zdCB1cGxvYWQgPSBtdWx0ZXIoe1xyXG4gIHN0b3JhZ2U6IG11bHRlci5tZW1vcnlTdG9yYWdlKCksXHJcbiAgbGltaXRzOiB7XHJcbiAgICBmaWxlU2l6ZTogMTAgKiAxMDI0ICogMTAyNCAvLyAxME1CIGxpbWl0XHJcbiAgfVxyXG59KTtcclxuXHJcbi8vIERpc2FibGUgYm9keSBwYXJzZXIgZm9yIHRoaXMgcm91dGUgdG8gaGFuZGxlIG11bHRpcGFydCBkYXRhXHJcbmV4cG9ydCBjb25zdCBjb25maWcgPSB7XHJcbiAgYXBpOiB7XHJcbiAgICBib2R5UGFyc2VyOiBmYWxzZSxcclxuICB9LFxyXG59O1xyXG5cclxuLy8gSGVscGVyIHRvIHJ1biBtdWx0ZXIgbWlkZGxld2FyZVxyXG5mdW5jdGlvbiBydW5NaWRkbGV3YXJlKHJlcTogYW55LCByZXM6IGFueSwgZm46IGFueSkge1xyXG4gIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7XHJcbiAgICBmbihyZXEsIHJlcywgKHJlc3VsdDogYW55KSA9PiB7XHJcbiAgICAgIGlmIChyZXN1bHQgaW5zdGFuY2VvZiBFcnJvcikge1xyXG4gICAgICAgIHJldHVybiByZWplY3QocmVzdWx0KTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gcmVzb2x2ZShyZXN1bHQpO1xyXG4gICAgfSk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIoXHJcbiAgcmVxOiBOZXh0QXBpUmVxdWVzdCxcclxuICByZXM6IE5leHRBcGlSZXNwb25zZVxyXG4pIHtcclxuICBpZiAocmVxLm1ldGhvZCAhPT0gJ1BPU1QnKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogJ01ldGhvZCBub3QgYWxsb3dlZCcgfSk7XHJcbiAgfVxyXG5cclxuICB0cnkge1xyXG4gICAgLy8gUnVuIG11bHRlciBtaWRkbGV3YXJlXHJcbiAgICBhd2FpdCBydW5NaWRkbGV3YXJlKHJlcSwgcmVzLCB1cGxvYWQuZmllbGRzKFtcclxuICAgICAgeyBuYW1lOiAnaW1hZ2UnLCBtYXhDb3VudDogMSB9LFxyXG4gICAgICB7IG5hbWU6ICdtYXNrJywgbWF4Q291bnQ6IDEgfVxyXG4gICAgXSkpO1xyXG5cclxuICAgIGNvbnN0IGZpbGVzID0gKHJlcSBhcyBhbnkpLmZpbGVzO1xyXG4gICAgY29uc3QgYm9keSA9IChyZXEgYXMgYW55KS5ib2R5O1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdyZXEuYm9keTonLCBib2R5KTtcclxuXHJcbiAgICBjb25zdCBwcm9tcHQgPSBib2R5LnByb21wdCB8fCAnJztcclxuICAgIGNvbnN0IG5lZ2F0aXZlUHJvbXB0ID0gYm9keS5uZWdhdGl2ZV9wcm9tcHQgfHwgJyc7XHJcbiAgICBjb25zdCBzdGVwcyA9IGJvZHkuc3RlcHM7XHJcbiAgICBjb25zdCBjZmdTY2FsZSA9IGJvZHkuY2ZnX3NjYWxlO1xyXG4gICAgY29uc3Qgc2FtcGxlcyA9IGJvZHkuc2FtcGxlcztcclxuICAgIGNvbnN0IGltYWdlRmlsZSA9IGZpbGVzWydpbWFnZSddPy5bMF07XHJcbiAgICBjb25zdCBtYXNrRmlsZSA9IGZpbGVzWydtYXNrJ10/LlswXTtcclxuXHJcbiAgICBpZiAoIVNUQUJJTElUWV9BUElfS0VZKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxyXG4gICAgICAgIGVycm9yOiAnU3RhYmlsaXR5IEFJIEFQSSBrZXkgbm90IGNvbmZpZ3VyZWQuIFBsZWFzZSBzZXQgU1RBQklMSVRZX0FQSV9LRVkgaW4geW91ciAuZW52LmxvY2FsIGZpbGUuJyBcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKCFpbWFnZUZpbGUgfHwgIW1hc2tGaWxlKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IFxyXG4gICAgICAgIGVycm9yOiAnQm90aCBpbWFnZSBhbmQgbWFzayBmaWxlcyBhcmUgcmVxdWlyZWQnIFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBQcm9jZXNzIGFuZCByZXNpemUgaW1hZ2UgYW5kIG1hc2sgdG8gMTAyNHgxMDI0XHJcbiAgICBjb25zdCB0YXJnZXRXaWR0aCA9IDEwMjQ7XHJcbiAgICBjb25zdCB0YXJnZXRIZWlnaHQgPSAxMDI0O1xyXG5cclxuICAgIC8vIEZvciB0aGUgaW1hZ2VcclxuICAgIGNvbnN0IGltYWdlQnVmZmVyID0gaW1hZ2VGaWxlLmJ1ZmZlcjtcclxuICAgIGNvbnN0IGltYWdlSmltcCA9IGF3YWl0IEppbXAucmVhZChpbWFnZUJ1ZmZlcik7XHJcbiAgICBpbWFnZUppbXAucmVzaXplKHRhcmdldFdpZHRoLCB0YXJnZXRIZWlnaHQpO1xyXG4gICAgY29uc3QgcHJvY2Vzc2VkSW1hZ2VCdWZmZXIgPSBhd2FpdCBpbWFnZUppbXAuZ2V0QnVmZmVyQXN5bmMoSmltcC5NSU1FX1BORyk7XHJcblxyXG4gICAgLy8gRm9yIHRoZSBtYXNrXHJcbiAgICBjb25zdCBtYXNrQnVmZmVyID0gbWFza0ZpbGUuYnVmZmVyO1xyXG4gICAgY29uc3QgbWFza0ltYWdlSmltcCA9IGF3YWl0IEppbXAucmVhZChtYXNrQnVmZmVyKTtcclxuICAgIG1hc2tJbWFnZUppbXBcclxuICAgICAgLnJlc2l6ZSh0YXJnZXRXaWR0aCwgdGFyZ2V0SGVpZ2h0KVxyXG4gICAgICAuZ3JleXNjYWxlKClcclxuICAgICAgLnNjYW4oMCwgMCwgdGFyZ2V0V2lkdGgsIHRhcmdldEhlaWdodCwgZnVuY3Rpb24gKHgsIHksIGlkeCkge1xyXG4gICAgICAgIC8vIElmIHBpeGVsIGlzIGNsb3NlciB0byB3aGl0ZSwgc2V0IHRvIHdoaXRlOyBlbHNlIHNldCB0byBibGFja1xyXG4gICAgICAgIGNvbnN0IHZhbHVlID0gdGhpcy5iaXRtYXAuZGF0YVtpZHhdID4gMTI4ID8gMjU1IDogMDtcclxuICAgICAgICB0aGlzLmJpdG1hcC5kYXRhW2lkeF0gPSB2YWx1ZTtcclxuICAgICAgICB0aGlzLmJpdG1hcC5kYXRhW2lkeCArIDFdID0gdmFsdWU7XHJcbiAgICAgICAgdGhpcy5iaXRtYXAuZGF0YVtpZHggKyAyXSA9IHZhbHVlO1xyXG4gICAgICAgIHRoaXMuYml0bWFwLmRhdGFbaWR4ICsgM10gPSAyNTU7IC8vIG9wYXF1ZVxyXG4gICAgICB9KTtcclxuICAgIGNvbnN0IHByb2Nlc3NlZE1hc2tCdWZmZXIgPSBhd2FpdCBtYXNrSW1hZ2VKaW1wLmdldEJ1ZmZlckFzeW5jKEppbXAuTUlNRV9QTkcpO1xyXG5cclxuICAgIC8vIENyZWF0ZSBmb3JtIGRhdGEgZm9yIG11bHRpcGFydCB1cGxvYWRcclxuICAgIGNvbnN0IGZvcm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7XHJcblxyXG4gICAgLy8gUmVxdWlyZWQgZmllbGRzXHJcbiAgICBmb3JtRGF0YS5hcHBlbmQoJ2ltYWdlJywgcHJvY2Vzc2VkSW1hZ2VCdWZmZXIsIHtcclxuICAgICAgZmlsZW5hbWU6ICdpbWFnZS5wbmcnLFxyXG4gICAgICBjb250ZW50VHlwZTogJ2ltYWdlL3BuZydcclxuICAgIH0pO1xyXG4gICAgZm9ybURhdGEuYXBwZW5kKCdwcm9tcHQnLCBwcm9tcHQpO1xyXG5cclxuICAgIC8vIE9wdGlvbmFsIGZpZWxkc1xyXG4gICAgaWYgKG1hc2tGaWxlKSB7XHJcbiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnbWFzaycsIHByb2Nlc3NlZE1hc2tCdWZmZXIsIHtcclxuICAgICAgICBmaWxlbmFtZTogJ21hc2sucG5nJyxcclxuICAgICAgICBjb250ZW50VHlwZTogJ2ltYWdlL3BuZydcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgICBpZiAobmVnYXRpdmVQcm9tcHQpIGZvcm1EYXRhLmFwcGVuZCgnbmVnYXRpdmVfcHJvbXB0JywgbmVnYXRpdmVQcm9tcHQpO1xyXG4gICAgaWYgKGJvZHkuc2VlZCkgZm9ybURhdGEuYXBwZW5kKCdzZWVkJywgYm9keS5zZWVkKTtcclxuICAgIGlmIChib2R5Lm91dHB1dF9mb3JtYXQpIHtcclxuICAgICAgZm9ybURhdGEuYXBwZW5kKCdvdXRwdXRfZm9ybWF0JywgYm9keS5vdXRwdXRfZm9ybWF0KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGZvcm1EYXRhLmFwcGVuZCgnb3V0cHV0X2Zvcm1hdCcsICdwbmcnKTtcclxuICAgIH1cclxuICAgIGlmIChib2R5LnN0eWxlX3ByZXNldCkgZm9ybURhdGEuYXBwZW5kKCdzdHlsZV9wcmVzZXQnLCBib2R5LnN0eWxlX3ByZXNldCk7XHJcbiAgICBpZiAoY2ZnU2NhbGUpIGZvcm1EYXRhLmFwcGVuZCgnY2ZnX3NjYWxlJywgY2ZnU2NhbGUpO1xyXG4gICAgaWYgKHN0ZXBzKSBmb3JtRGF0YS5hcHBlbmQoJ3N0ZXBzJywgc3RlcHMpO1xyXG5cclxuICAgIGNvbnNvbGUubG9nKCdQcm9tcHQ6JywgcHJvbXB0KTtcclxuICAgIGNvbnNvbGUubG9nKCdOZWdhdGl2ZSBQcm9tcHQ6JywgbmVnYXRpdmVQcm9tcHQpO1xyXG4gICAgY29uc29sZS5sb2coJ1Byb2Nlc3NlZCBpbWFnZSBidWZmZXIgc2l6ZTonLCBwcm9jZXNzZWRJbWFnZUJ1ZmZlci5sZW5ndGgpO1xyXG4gICAgY29uc29sZS5sb2coJ1Byb2Nlc3NlZCBtYXNrIGJ1ZmZlciBzaXplOicsIHByb2Nlc3NlZE1hc2tCdWZmZXIubGVuZ3RoKTtcclxuXHJcbiAgICAvLyBMb2cgRm9ybURhdGEgZmllbGRzXHJcbiAgICBjb25zb2xlLmxvZygnRm9ybURhdGEgZmllbGRzOicpO1xyXG4gICAgY29uc29sZS5sb2coJ1R5cGUgb2YgZm9ybURhdGE6JywgdHlwZW9mIGZvcm1EYXRhKTtcclxuICAgIGNvbnNvbGUubG9nKCdmb3JtRGF0YSBjb25zdHJ1Y3RvcjonLCBmb3JtRGF0YS5jb25zdHJ1Y3Rvci5uYW1lKTtcclxuICAgIFxyXG4gICAgLy8gQWx0ZXJuYXRpdmUgbG9nZ2luZyBhcHByb2FjaCB0aGF0IGRvZXNuJ3QgcmVseSBvbiBmb3JFYWNoXHJcbiAgICB0cnkge1xyXG4gICAgICBpZiAodHlwZW9mIChmb3JtRGF0YSBhcyBhbnkpLmZvckVhY2ggPT09ICdmdW5jdGlvbicpIHtcclxuICAgICAgICAoZm9ybURhdGEgYXMgYW55KS5mb3JFYWNoKCh2YWx1ZTogYW55LCBrZXk6IGFueSkgPT4ge1xyXG4gICAgICAgICAgaWYgKEJ1ZmZlci5pc0J1ZmZlcih2YWx1ZSkgfHwgdmFsdWUgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgICR7a2V5fTogW2JpbmFyeSwgbGVuZ3RoICR7dmFsdWUubGVuZ3RofV1gKTtcclxuICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGAgICR7a2V5fTpgLCB2YWx1ZSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ0Zvcm1EYXRhIGZvckVhY2ggbWV0aG9kIG5vdCBhdmFpbGFibGUnKTtcclxuICAgICAgICAvLyBKdXN0IGxvZyB0aGF0IEZvcm1EYXRhIHdhcyBjcmVhdGVkIHN1Y2Nlc3NmdWxseVxyXG4gICAgICAgIGNvbnNvbGUubG9nKCdGb3JtRGF0YSBvYmplY3QgY3JlYXRlZCBzdWNjZXNzZnVsbHknKTtcclxuICAgICAgICBjb25zdCBoZWFkZXJzID0gZm9ybURhdGEuZ2V0SGVhZGVycygpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdGb3JtRGF0YSBoZWFkZXJzOicsIGhlYWRlcnMpO1xyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcjogYW55KSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdFcnJvciBsb2dnaW5nIEZvcm1EYXRhIGZpZWxkczonLCBlcnJvci5tZXNzYWdlKTtcclxuICAgIH1cclxuXHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGF4aW9zLnBvc3QoU1RBQklMSVRZX0lOUEFJTlRfVVJMLCBmb3JtRGF0YSwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7U1RBQklMSVRZX0FQSV9LRVl9YCxcclxuICAgICAgICAuLi5mb3JtRGF0YS5nZXRIZWFkZXJzKCksXHJcbiAgICAgICAgJ0FjY2VwdCc6ICdhcHBsaWNhdGlvbi9qc29uJ1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuXHJcbiAgICAvLyBIYW5kbGUgdjJiZXRhIHJlc3BvbnNlXHJcbiAgICBsZXQgaW1hZ2VzID0gW107XHJcbiAgICBpZiAocmVzcG9uc2UuZGF0YS5pbWFnZSkge1xyXG4gICAgICBpbWFnZXMucHVzaCh7XHJcbiAgICAgICAgYmFzZTY0OiBgZGF0YTppbWFnZS9wbmc7YmFzZTY0LCR7cmVzcG9uc2UuZGF0YS5pbWFnZX1gLFxyXG4gICAgICAgIHNlZWQ6IHJlc3BvbnNlLmRhdGEuc2VlZFxyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSBpZiAoQXJyYXkuaXNBcnJheShyZXNwb25zZS5kYXRhLmltYWdlcykpIHtcclxuICAgICAgaW1hZ2VzID0gcmVzcG9uc2UuZGF0YS5pbWFnZXMubWFwKChpbWc6IGFueSkgPT4gKHtcclxuICAgICAgICBiYXNlNjQ6IGBkYXRhOmltYWdlL3BuZztiYXNlNjQsJHtpbWcuaW1hZ2V9YCxcclxuICAgICAgICBzZWVkOiBpbWcuc2VlZFxyXG4gICAgICB9KSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICAvLyBVbmV4cGVjdGVkIHJlc3BvbnNlXHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDUwMCkuanNvbih7XHJcbiAgICAgICAgZXJyb3I6ICdVbmV4cGVjdGVkIHJlc3BvbnNlIGZyb20gU3RhYmlsaXR5IEFQSScsXHJcbiAgICAgICAgZGV0YWlsczogcmVzcG9uc2UuZGF0YVxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICByZXMuanNvbih7IFxyXG4gICAgICBzdWNjZXNzOiB0cnVlLCBcclxuICAgICAgaW1hZ2VzLFxyXG4gICAgICB1c2FnZTogcmVzcG9uc2UuZGF0YS51c2FnZVxyXG4gICAgfSk7XHJcblxyXG4gIH0gY2F0Y2ggKGVycm9yOiBhbnkpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGlucGFpbnRpbmcgaW1hZ2U6JywgZXJyb3IucmVzcG9uc2U/LmRhdGEgfHwgZXJyb3IubWVzc2FnZSB8fCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IFxyXG4gICAgICBlcnJvcjogJ0ZhaWxlZCB0byBpbnBhaW50IGltYWdlJyxcclxuICAgICAgZGV0YWlsczogZXJyb3IucmVzcG9uc2U/LmRhdGEgfHwgZXJyb3IubWVzc2FnZSB8fCBlcnJvclxyXG4gICAgfSk7XHJcbiAgfVxyXG59ICJdLCJuYW1lcyI6WyJheGlvcyIsIm11bHRlciIsIkppbXAiLCJGb3JtRGF0YSIsIlNUQUJJTElUWV9BUElfS0VZIiwicHJvY2VzcyIsImVudiIsIlNUQUJJTElUWV9JTlBBSU5UX1VSTCIsInVwbG9hZCIsInN0b3JhZ2UiLCJtZW1vcnlTdG9yYWdlIiwibGltaXRzIiwiZmlsZVNpemUiLCJjb25maWciLCJhcGkiLCJib2R5UGFyc2VyIiwicnVuTWlkZGxld2FyZSIsInJlcSIsInJlcyIsImZuIiwiUHJvbWlzZSIsInJlc29sdmUiLCJyZWplY3QiLCJyZXN1bHQiLCJFcnJvciIsImhhbmRsZXIiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJmaWVsZHMiLCJuYW1lIiwibWF4Q291bnQiLCJmaWxlcyIsImJvZHkiLCJjb25zb2xlIiwibG9nIiwicHJvbXB0IiwibmVnYXRpdmVQcm9tcHQiLCJuZWdhdGl2ZV9wcm9tcHQiLCJzdGVwcyIsImNmZ1NjYWxlIiwiY2ZnX3NjYWxlIiwic2FtcGxlcyIsImltYWdlRmlsZSIsIm1hc2tGaWxlIiwidGFyZ2V0V2lkdGgiLCJ0YXJnZXRIZWlnaHQiLCJpbWFnZUJ1ZmZlciIsImJ1ZmZlciIsImltYWdlSmltcCIsInJlYWQiLCJyZXNpemUiLCJwcm9jZXNzZWRJbWFnZUJ1ZmZlciIsImdldEJ1ZmZlckFzeW5jIiwiTUlNRV9QTkciLCJtYXNrQnVmZmVyIiwibWFza0ltYWdlSmltcCIsImdyZXlzY2FsZSIsInNjYW4iLCJ4IiwieSIsImlkeCIsInZhbHVlIiwiYml0bWFwIiwiZGF0YSIsInByb2Nlc3NlZE1hc2tCdWZmZXIiLCJmb3JtRGF0YSIsImFwcGVuZCIsImZpbGVuYW1lIiwiY29udGVudFR5cGUiLCJzZWVkIiwib3V0cHV0X2Zvcm1hdCIsInN0eWxlX3ByZXNldCIsImxlbmd0aCIsImNvbnN0cnVjdG9yIiwiZm9yRWFjaCIsImtleSIsIkJ1ZmZlciIsImlzQnVmZmVyIiwiVWludDhBcnJheSIsImhlYWRlcnMiLCJnZXRIZWFkZXJzIiwibWVzc2FnZSIsInJlc3BvbnNlIiwicG9zdCIsImltYWdlcyIsImltYWdlIiwicHVzaCIsImJhc2U2NCIsIkFycmF5IiwiaXNBcnJheSIsIm1hcCIsImltZyIsImRldGFpbHMiLCJzdWNjZXNzIiwidXNhZ2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./pages/api/inpaint-image.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Finpaint-image&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cinpaint-image.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();